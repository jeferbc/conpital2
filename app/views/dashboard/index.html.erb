<% provide(:page_title, "Dashboard") %>
<% provide(:dashboard_active, 'active') %>

<body class="full">

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <a class="navbar-brand" href="/">Conpital</a>

      <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
        <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
          <li class="nav-item">
            <%= link_to "Dashboard", dashboard_index_path, class: "nav-link #{yield(:dashboard_active)}" %>
          </li>
          <li class="nav-item">
            <%= link_to "Expenses", expenses_path, class: "nav-link #{yield(:expenses_active)}" %>
          </li>
          <% if signed_in? %>
            <li class="nav-item"><%= link_to "Log Out", destroy_user_session_path, method: :delete, class: "nav-link" %></li>
          <% else %>
            <li class="nav-item">
              <%= link_to "Log In", new_user_session_path, class: "nav-link #{yield(:login_active)}" %>
            </li>
            <li class="nav-item">
              <%= link_to "Sign Up", new_user_registration_path, class: "nav-link #{yield(:signup_active)}" %>
            </li>
          <% end %>
        </ul>
      </div>
    </div>
  </nav>

<!-- Inicio Resumen -->
  <div class="container resumen text-center">
    <div class="row">
      <h5 class="col-3"><%= number_to_currency(@amount_of_today) %> COP</h5>
      <h5 class="col-3"><%= number_to_currency(@amount_of_yesterday) %> COP</h5>
      <h5 class="col-3"><%= number_to_currency(@amount_of_current_month) %> COP</h5>
      <h5 class="col-3"><%= number_to_currency(@amount_of_last_month) %> COP</h5>
    </div>
    <div class="row">
      <p class="col-3">TODAY</p>
      <p class="col-3">YESTERDAY</p>
      <p class="col-3">THIS MONTH</p>
      <p class="col-3">LAST MONTH</p>
    </div>
  </div>
<!-- Fin Resumen -->

<!-- Inicio Gráficos -->
  <div class="container">
    <div class="row">

      <h6 class="col-6 title">Last 6 months
        <%= column_chart  @handler.last_six_months_expenses_transaction_type_overview.joins(:transaction_type).group('transaction_types.name').group_by_month(:date, last: 6, format: "%b %e").count, stacked: true, colors: ["#379EAB", "#C24543", "#805F83", "#86B40B"] %>
        <!-- colors: Azul, Rojo, Morado, Verde -->
      </h6>

     
      <h6 class="col-6 title">By day
        <%= column_chart @handler.this_month.joins(:transaction_type).group('transaction_types.name').group_by_day(:date, format: "%e").sum(:amount), colors: ["#379EAB", "#C24543", "#805F83", "#86B40B"] %>
        <!-- colors: Azul, Rojo, Morado, Verde -->
      </h6>

    </div>
    <div class="row">

      <h6 class="col-6 title">By category
        <%= pie_chart Expense.group(:category).count, donut: true %>
      </h6>

      <h6 class="col-6 title">Accumulated
        <%=  area_chart [
          {name: "Current Month", data: Expense.group_by_month(:date, last: 1).count},
          {name: "Last Month", data: Expense.group_by_month(:date, last: 1, current: false).count}
        ]%>
        <!--<span class="d-block text-center"><span class="blue">Current Month</span> — <span class="red">Last Month</span></span>-->
      </h6>

    </div>
  </div>
<!-- Fin Gráficos -->

<!--<script>
// Inicio Last 6 months //
  Morris.Bar({
    element: 'chartOne',
    data: [
      { y: '<%#= 5.months.ago.strftime("%b %e") %>', a: 25, b: 10, c: 50, d:  0 },
      { y: '<%#= 4.months.ago.strftime("%b %e") %>', a: 15, b: 35, c:  0, d: 25 },
      { y: '<%#= 3.months.ago.strftime("%b %e") %>', a: 50, b: 40, c: 50, d: 25 },
      { y: '<%#= 2.months.ago.strftime("%b %e") %>', a: 55, b: 40, c: 20, d: 25 },
      { y: '<%#= 1.months.ago.strftime("%b %e") %>', a:  0, b: 40, c: 50, d:  0 },
      { y: '<%#= 0.months.ago.strftime("%b %e") %>', a: 20, b:  0, c: 50, d: 25 },
    ],
    xkey: 'y',
    ykeys: ['a', 'b', 'c', 'd'],
    labels: ['Purchases', 'Withdrawals', 'Transfers', 'Payments'],
    barColors: ['#379EAB', '#C24545', '#805F81', '#86B40B'],
    stacked: true,
    hideHover: true,
  });
// Fin Last 6 months //

// Inicio By day //
  Morris.Bar({
    element: 'chartTwo',
    data: [
      { y: '01', a: 20, b:  0, c:  0, d:  0 },
      { y: '02', a: 45, b: 25, c:  0, d:  0 },
      { y: '03', a: 20, b:  0, c:  0, d:  0 },
      { y: '04', a: 25, b:  0, c:  0, d:  0 },
      { y: '05', a: 30, b: 40, c:  0, d:  0 },
      { y: '06', a: 15, b: 15, c: 50, d: 25 },
      { y: '07', a: 40, b:  0, c:  0, d:  0 },
      { y: '08', a:  0, b: 10, c:  0, d:  0 },
      { y: '09', a:  0, b:  0, c:  0, d: 25 },
      { y: '10', a:  0, b:  0, c: 40, d:  0 },
      { y: '11', a:  0, b: 10, c:  0, d: 25 },
      { y: '12', a:  5, b:  0, c:  0, d: 25 },
      { y: '13', a:  0, b: 40, c:  0, d: 25 },
      { y: '14', a: 32, b:  0, c:  0, d:  0 },
      { y: '15', a:  0, b:  0, c:  0, d: 25 },
      { y: '16', a:  0, b:  0, c: 50, d: 25 },
    ],
    xkey: 'y',
    ykeys: ['a', 'b', 'c', 'd'],
    labels: ['Purchases', 'Withdrawals', 'Transfers', 'Payments'],
    barColors: ['#379EAB', '#C24545', '#805F81', '#86B40B'],
    hideHover: true,
  });
// Fin By day //

// Inicio By category //
  Morris.Donut({
    element: 'chartThree',
    data: [
      {label: "Restaurant", value: 0},
      {label: "Grocery", value: 20},
      {label: "Car", value: 30},
      {label: "Services", value: 10},
      {label: "Home", value: 0},
      {label: "Education", value: 20},
      {label: "Fun", value: 10},
      {label: "Travel", value: 10}
    ],
    colors: ['#379EAB', '#C24545', '#805F81', '#86B40B', '#F2DCD0', '#F7E154', '#305CD3', '#EFA834'],
  });
// Fin By category //

// Inicio Accumulated //
  Morris.Area({
    element: 'chartFour',
    data: [
      { y: '<%#= 1.month.ago.strftime("%b %e") %>', a: 100, b: 200 },
      { y: '<%#= 0.months.ago.strftime("%b %e") %>', a: 80, b: 10 }
    ],
    xkey: 'y',
    ykeys: ['a', 'b'],
    labels: ['Last Month', 'Current Month'],
    lineColors: ['#379EAB', '#C24545'],
    hideHover: true
  });
// Fin Accumulated //
</script>-->

</body>